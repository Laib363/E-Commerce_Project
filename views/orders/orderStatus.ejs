<% layout('layouts/boilerplate') %>

<div class="container">
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <h1 class="mb-3">Order Status: #<%= order.orderId %></h1>
      <p classV"lead">Placed on: <%= new Date(order.orderDate).toDateString() %></p>

      <!-- Progress Bar -->
      <div class="my-4">
        <% 
          let progress = 25;
          if (order.status === 'Shipped') progress = 65;
          if (order.status === 'Delivered') progress = 100;
        %>
        <div class="progress" style="height: 30px;">
          <div 
            class="progress-bar 
              <% if (progress === 100) { %>
                bg-success
              <% } else if (progress === 65) { %>
                bg-primary
              <% } else { %>
                bg-warning
              <% } %>" 
            role="progressbar" 
            style="width: <%= progress %>%;" 
            aria-valuenow="<%= progress %>" 
            aria-valuemin="0" 
            aria-valuemax="100">
            <%= order.status %>
          </div>
        </div>
        <div class="d-flex justify-content-between mt-1">
          <small>Order Placed</small>
          <small>Shipped</small>
          <small>Delivered</small>
        </div>
      </div>
      
      <p><strong>Estimated Delivery:</strong> <%= new Date(order.estimatedDelivery).toDateString() %></p>
      
      <hr class="my-4">

      <h4>Items in this Order</h4>
      <div class="row">
        <% order.items.forEach(item => { %>
          <div class="col-md-6 mb-3">
            <div class="card h-100">
              <div class="row g-0">
                <div class="col-md-4">
                  <img src="<%= item.image %>" class="img-fluid rounded-start" alt="<%= item.title %>">
                </div>
                <div class="col-md-8">
                  <div class="card-body">
                    <h5 class="card-title"><%= item.title %></h5>&nbsp; &nbsp;
                    <p class="card-text fw-bold">PKR<%= item.price.toLocaleString("en-pk") %></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      </div>

    </div>
  </div>
</div>